---
title: "ETO5513 Team Project"
author: "Gun Ho Jang & Rylie Douglas"
date: "`r Sys.Date()`"
output: 
  html_document:
    toc: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
# Load required libraries
library(tidyverse)
library(knitr)
library(kableExtra)
library(renv)
```

```{r load-data}
# Read the data
temp_data <- read.csv("Data/decadal-average-surface-temperature.csv")
```
# Introduction

# Data Description
This analysis uses decadal surface temperature data (1940-2010) from Our World in Data enabling the analysis of long-term temperature patterns. The dataset spans from 1940 to 2010, measuring temperature changes across different countries globally through three main variables: country names, decadal time points, and mean surface temperatures in degrees Celsius (°C).

## Section 1 - Macro Level - Gun Ho Jang


## Section 2 - Micro level - Rylie Douglas
### Research Questions
This section investigates temperature variations at the country level, focusing on both long-term changes and temperature variability. The analysis addresses two primary research questions:

1. What are the patterns of temperature change across different climatic regions during this time period?

2. Which countries experienced the most unstable or variable temperatures during this time period?

### Results and Analysis

#### Research Question 1: Temperature Comparisons Across Countries

```{r temperature-change, fig.width=12, fig.height=6}
# Calculate total temperature change for each country
temp_changes <- temp_data %>%
  group_by(Entity) %>%
  summarise(
    start_temp = first(Decadal.average.surface.temperature),
    end_temp = last(Decadal.average.surface.temperature),
    total_change = end_temp - start_temp
  ) %>%
  arrange(desc(abs(total_change)))

# Get top 10 countries with greatest change
top_10_countries <- head(temp_changes$Entity, 10)

# Create figure 1: Line graph for top 10 countries with enhanced width
temp_data %>%
  filter(Entity %in% top_10_countries) %>%
  ggplot(aes(x = Year, y = Decadal.average.surface.temperature, color = Entity)) +
  geom_line(linewidth = 1.2) +
  geom_point(size = 3) +
  theme_minimal() +
  theme(
    legend.position = "right",
    legend.title = element_blank(),
    legend.text = element_text(size = 10),
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12),
    plot.title = element_text(size = 14, face = "bold"),
    panel.grid.minor = element_blank(),
    plot.margin = margin(t = 20, r = 20, b = 20, l = 20),
    panel.background = element_rect(fill = "white", color = "black"),
    plot.background = element_rect(fill = "white", color = "black")
  ) +
  labs(
    title = "Figure 1: Temperature Trends for Countries with Greatest Change (1940-2010)",
    x = "Year",
    y = "Average Temperature (°C)",
    caption = "Shows the 10 countries with largest absolute temperature change"
  ) +
  scale_x_continuous(breaks = unique(temp_data$Year)) +
  scale_y_continuous(breaks = seq(0, 30, by = 5)) +
  scale_color_brewer(palette = "Spectral")
```
Figure 1 shows the trajectories of the ten countries with the most substantial temperature changes from 1940 to 2010. It can be seen that there is a slight upward trend of the yearly average  temperatures for these countries over time, revealing particularly notable increases in Nordic regions.

```{r change-table}
# Table 1: Temperature changes for top 10 countries
temp_changes %>%
  head(10) %>%
  mutate(
    Rank = row_number(),
    total_change = round(total_change, 2),
    start_temp = round(start_temp, 2),
    end_temp = round(end_temp, 2)
  ) %>%
  select(Rank, Entity, start_temp, end_temp, total_change) %>%
  kable(
    caption = "Table 1: Countries with Greatest Temperature Change (1940-2010)",
    col.names = c("Rank", "Country", "1940 Mean Temperature (°C)",
                  "2010 Mean Temperature (°C)", "Total Change (°C)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered"))
```
Table 1 reveals diverse patterns of temperature change across different climatic regions. Norway experienced the most significant increase of 2.91°C (from -1.70°C to 1.21°C), followed by Iceland with a 2.66°C rise (from -0.45°C to 2.21°C). Niger also shows a significant 2.65°C increase from a much higher average temperature (25.31°C to 27.96°C). It can be seen that cold climate countries (Norway, Iceland and Belarus) and hot climate countries (Niger, Saudi Arabia, Sudan, Eritrea) appear in the top rankings. Total mean temperature changes affected various climatic regions, however cold regions displayed slightly larger absolute changes over the 70-year period.

#### Research Question 2: Temperature variability
```{r variability-analysis, fig.width=12, fig.height=6}
# Calculate temperature variability metrics
variability_analysis <- temp_data %>%
  group_by(Entity) %>%
  summarise(
    Temp_SD = sd(Decadal.average.surface.temperature),
    Temp_Range = max(Decadal.average.surface.temperature) - 
                 min(Decadal.average.surface.temperature),
    Temp_CV = (sd(Decadal.average.surface.temperature) / 
               mean(Decadal.average.surface.temperature)) * 100
  ) %>%
  arrange(desc(Temp_SD))

# Create figure 2: Top 15 most variable countries with enhanced width
ggplot(head(variability_analysis, 15),
       aes(x = reorder(Entity, Temp_SD), y = Temp_SD)) +
  geom_bar(stat = "identity", fill = "#8B0000", alpha = 0.7) +
  coord_flip() +
  theme_minimal() +
  theme(
    axis.text = element_text(size = 10),
    axis.title = element_text(size = 12),
    plot.title = element_text(size = 14, face = "bold"),
    panel.grid.minor = element_blank(),
    plot.margin = margin(t = 20, r = 20, b = 20, l = 20),
    panel.background = element_rect(fill = "white", color = "black"),
    plot.background = element_rect(fill = "white", color = "black")
  ) +
  labs(
    title = "Figure 2: 15 Countries with Highest Temperature Variability",
    x = "Country",
    y = "Temperature Standard Deviation (°C)",
    caption = "Higher values indicate greater temperature fluctuations"
  )
```
Figure 2 displays temperature variability across 15 countries from 1940 to 2010, measured by standard deviation (SD). Nordic countries show the most significant fluctuations, with Norway recording the highest variability (SD = 1.17°C), followed closely by Iceland (SD = 1.10°C). This pattern aligns with previous studies of Scandinavian climate variability, which have shown that Nordic regions experience greater temperature fluctuations due to their atmospheric circulation patterns and geographical position (Hanssen-Bauer et al., 2015). These findings suggest that northern regions, particularly Scandinavia, experienced more unstable temperature patterns compared to other global regions during this period, which is consistent with research showing that high-latitude areas are more sensitive to climate variations.

```{r variability-table}
# Table 2: Detailed variability metrics for top 10 countries
head(variability_analysis, 10) %>%
  mutate(
    Rank = row_number(),
    Temp_SD = round(Temp_SD, 2),
    Temp_Range = round(Temp_Range, 2),
    Temp_CV = round(Temp_CV, 2)
  ) %>%
  select(Rank, Entity, Temp_SD, Temp_Range, Temp_CV) %>%
  kable(
    caption = "Table 2: Top 10 Countries with Highest Temperature Variability",
    col.names = c("Rank", "Country", "Standard Deviation (°C)",
                  "Temperature Range (°C)", "Coefficient of Variation (%)")
  ) %>%
  kable_styling(bootstrap_options = c("striped", "hover", "bordered"))
```
Table 2 presents temperature variability through three distinct metrics for the top 10 countries: standard deviation measuring absolute variability, temperature range indicating the interval between the extremes and coefficient of variation (CV) indicating relative variability. Norway has the highest standard deviation (1.17°C), temperature range (3.07°C) and has a negative coefficient of variation (-290.82%), which suggests extreme temperature fluctuations around its mean. Iceland shows the next highest CV  of 168.34%. On the other hand, other high ranking countries like Saudi Arabia, Niger, and Yemen exhibit more moderate coefficients between 2-4%, this indicates that their temperature variations were less extreme relative to their higher mean temperatures.

# Conclusion

# References
Hanssen-Bauer, I., Førland, E. J., Haddeland, I., Hisdal, H., Mayer, S., Nesje, A., Nilsen, J.E.Ø., Sandven, S., Sandø, A.B., Sorteberg, A., & Ådlandsvik, B. (2015). Climate in Norway 2100 – knowledge basis for climate adaptation. NCCS report no. 1/2015. Norwegian Climate Service Centre.